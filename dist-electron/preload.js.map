{"version":3,"file":"preload.js","sources":["../electron/preload.ts"],"sourcesContent":["import { ipcRenderer, contextBridge } from 'electron';\nimport { cosResponse, cosResponseData, createCollectionData } from './interfaces/requestsInt';\nimport { dbCollection } from './interfaces/databaseInt';\n\ncontextBridge.exposeInMainWorld('ipcRenderer', ipcRenderer);\n\nfunction domReady(condition: DocumentReadyState[] = ['complete', 'interactive']) {\n  return new Promise((resolve) => {\n    if (condition.includes(document.readyState)) {\n      resolve(true);\n    } else {\n      document.addEventListener('readystatechange', () => {\n        if (condition.includes(document.readyState)) {\n          resolve(true);\n        }\n      });\n    }\n  });\n}\n\nconst safeDOM = {\n  append(parent: HTMLElement, child: HTMLElement) {\n    if (!Array.from(parent.children).find((e) => e === child)) {\n      return parent.appendChild(child);\n    }\n\n    return null;\n  },\n  remove(parent: HTMLElement, child: HTMLElement) {\n    if (parent && Array.from(parent.children).find((e) => e === child)) {\n      return parent.removeChild(child);\n    }\n\n    return null;\n  }\n};\n\n/**\n * https://tobiasahlin.com/spinkit\n * https://connoratherton.com/loaders\n * https://projects.lukehaas.me/css-loaders\n * https://matejkustec.github.io/SpinThatShit\n */\nfunction useLoading() {\n  const styleContent = `\n  .sk-chase {\n  \n  }\n\n  .sk-chase-dot {\n      width: 40px;\n      height: 40px;\n      position: absolute;\n      margin: auto;\n      animation: sk-chase-dot 2.0s infinite ease-in-out both;\n  }\n\n  .sk-chase-dot:before {\n    content: '';\n    display: block;\n    width: 25%;\n    height: 25%;\n    background-color: #fff;\n    border-radius: 100%;\n    animation: sk-chase-dot-before 2.0s infinite ease-in-out both; \n  }\n\n  .sk-chase-dot:nth-child(1) { animation-delay: -1.1s; }\n  .sk-chase-dot:nth-child(2) { animation-delay: -1.0s; }\n  .sk-chase-dot:nth-child(3) { animation-delay: -0.9s; }\n  .sk-chase-dot:nth-child(4) { animation-delay: -0.8s; }\n  .sk-chase-dot:nth-child(5) { animation-delay: -0.7s; }\n  .sk-chase-dot:nth-child(6) { animation-delay: -0.6s; }\n  .sk-chase-dot:nth-child(1):before { animation-delay: -1.1s; }\n  .sk-chase-dot:nth-child(2):before { animation-delay: -1.0s; }\n  .sk-chase-dot:nth-child(3):before { animation-delay: -0.9s; }\n  .sk-chase-dot:nth-child(4):before { animation-delay: -0.8s; }\n  .sk-chase-dot:nth-child(5):before { animation-delay: -0.7s; }\n  .sk-chase-dot:nth-child(6):before { animation-delay: -0.6s; }\n  \n  @keyframes sk-chase {\n    100% { transform: rotate(360deg); } \n  }\n  \n  @keyframes sk-chase-dot {\n    80%, 100% { transform: rotate(360deg); } \n  }\n\n  @keyframes sk-chase-dot-before {\n    50% {\n      transform: scale(0.4); \n    } 100%, 0% {\n      transform: scale(1.0); \n    } \n  }\n\n  .app-loading-wrap {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: #282c34;\n    z-index: 9;\n  }\n  `;\n\n  const htmlContent = `\n    <div clas=\"sk-chase\">\n      <div class=\"sk-chase-dot\"></div>\n      <div class=\"sk-chase-dot\"></div>\n      <div class=\"sk-chase-dot\"></div>\n      <div class=\"sk-chase-dot\"></div>\n      <div class=\"sk-chase-dot\"></div>\n      <div class=\"sk-chase-dot\"></div>\n    </div>\n  `;\n\n  const oStyle = document.createElement('style');\n  const oDiv = document.createElement('div');\n\n  oStyle.id = 'app-loading-style';\n  oStyle.innerHTML = styleContent;\n  oDiv.id = 'loading-to-remove';\n  oDiv.className = 'app-loading-wrap';\n  oDiv.innerHTML = htmlContent;\n\n  return {\n    appendLoading() {\n      safeDOM.append(document.head, oStyle);\n      safeDOM.append(document.body, oDiv);\n    },\n    removeLoading() {\n      safeDOM.remove(document.head, oStyle);\n      safeDOM.remove(document.body, oDiv);\n    }\n  };\n}\n\nconst { appendLoading, removeLoading } = useLoading();\n\ndomReady().then(appendLoading);\n\ndeclare global {\n  interface Window {\n    Main: typeof api;\n    ipcRenderer: typeof ipcRenderer;\n  }\n}\n\nconst api = {\n  sendMessage: (message: string) => {\n    ipcRenderer.send('message', message);\n  },\n  Minimize: (): Promise<string> => ipcRenderer.invoke('minimize'),\n  removeLoading: () => {\n    removeLoading();\n  },\n  // collection handlers\n  createCollection: (data: createCollectionData): Promise<cosResponse> => ipcRenderer.invoke('createCollection', data),\n  getCollections: (): Promise<cosResponseData<dbCollection>> => ipcRenderer.invoke('getCollections'),\n  /**\n   * Provide an easier way to listen to events\n   */\n  on: (channel: string, callback: (data: any) => void) => {\n    ipcRenderer.on(channel, (_, data) => callback(data));\n  }\n};\n\ncontextBridge.exposeInMainWorld('Main', api);\n"],"names":["contextBridge","ipcRenderer"],"mappings":";;AAIAA,SAAAA,cAAc,kBAAkB,eAAeC,SAAAA,WAAW;AAE1D,SAAS,SAAS,YAAkC,CAAC,YAAY,aAAa,GAAG;AACxE,SAAA,IAAI,QAAQ,CAAC,YAAY;AAC9B,QAAI,UAAU,SAAS,SAAS,UAAU,GAAG;AAC3C,cAAQ,IAAI;AAAA,IAAA,OACP;AACI,eAAA,iBAAiB,oBAAoB,MAAM;AAClD,YAAI,UAAU,SAAS,SAAS,UAAU,GAAG;AAC3C,kBAAQ,IAAI;AAAA,QACd;AAAA,MAAA,CACD;AAAA,IACH;AAAA,EAAA,CACD;AACH;AAEA,MAAM,UAAU;AAAA,EACd,OAAO,QAAqB,OAAoB;AAC1C,QAAA,CAAC,MAAM,KAAK,OAAO,QAAQ,EAAE,KAAK,CAAC,MAAM,MAAM,KAAK,GAAG;AAClD,aAAA,OAAO,YAAY,KAAK;AAAA,IACjC;AAEO,WAAA;AAAA,EACT;AAAA,EACA,OAAO,QAAqB,OAAoB;AAC1C,QAAA,UAAU,MAAM,KAAK,OAAO,QAAQ,EAAE,KAAK,CAAC,MAAM,MAAM,KAAK,GAAG;AAC3D,aAAA,OAAO,YAAY,KAAK;AAAA,IACjC;AAEO,WAAA;AAAA,EACT;AACF;AAQA,SAAS,aAAa;AACpB,QAAM,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAkErB,QAAM,cAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWd,QAAA,SAAS,SAAS,cAAc,OAAO;AACvC,QAAA,OAAO,SAAS,cAAc,KAAK;AAEzC,SAAO,KAAK;AACZ,SAAO,YAAY;AACnB,OAAK,KAAK;AACV,OAAK,YAAY;AACjB,OAAK,YAAY;AAEV,SAAA;AAAA,IACL,gBAAgB;AACN,cAAA,OAAO,SAAS,MAAM,MAAM;AAC5B,cAAA,OAAO,SAAS,MAAM,IAAI;AAAA,IACpC;AAAA,IACA,gBAAgB;AACN,cAAA,OAAO,SAAS,MAAM,MAAM;AAC5B,cAAA,OAAO,SAAS,MAAM,IAAI;AAAA,IACpC;AAAA,EAAA;AAEJ;AAEA,MAAM,EAAE,eAAe,kBAAkB;AAEzC,WAAW,KAAK,aAAa;AAS7B,MAAM,MAAM;AAAA,EACV,aAAa,CAAC,YAAoB;AACpBA,aAAAA,YAAA,KAAK,WAAW,OAAO;AAAA,EACrC;AAAA,EACA,UAAU,MAAuBA,SAAAA,YAAY,OAAO,UAAU;AAAA,EAC9D,eAAe,MAAM;AACL;EAChB;AAAA,EAEA,kBAAkB,CAAC,SAAqDA,SAAAA,YAAY,OAAO,oBAAoB,IAAI;AAAA,EACnH,gBAAgB,MAA8CA,SAAAA,YAAY,OAAO,gBAAgB;AAAA,EAIjG,IAAI,CAAC,SAAiB,aAAkC;AACtDA,yBAAY,GAAG,SAAS,CAAC,GAAG,SAAS,SAAS,IAAI,CAAC;AAAA,EACrD;AACF;AAEAD,SAAAA,cAAc,kBAAkB,QAAQ,GAAG;"}